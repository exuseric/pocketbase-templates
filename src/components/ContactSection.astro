---
import { Icon } from "astro-icon/components";
import { Image } from "astro:assets";
import SectionHeading from "./SectionHeading.astro";
import { getImageUrl } from "../pb";

let hasMedia = false;
let url = null;
const { data, IframeSrc } = Astro.props;
const { SectionTitle, SectionExcerpt, SectionBody, SectionImage, expand } =
    data;
// if(expand?.SectionImage) {
//     hasMedia = true
//     url = pb.files.getUrl(expand.SectionImage, expand.SectionImage.Image, { thumb: "0x500" });
// }
---

<section class="container px-4 my-16 scroll-m-24" id="contact">
    <SectionHeading sectionTitle={SectionTitle} excerpt={SectionExcerpt} />
    <div class="sm:max-w-xl md:max-w-full lg:max-w-screen-xl">
        <div class="grid gap-10 lg:grid-cols-2">
            <div class="lg:pr-10">
                <article class="max-w-prose">
                    <slot set:html={SectionBody} />
                </article>
            </div>
            <div class="max-w-prose">
                {
                    expand ? (
                        <Image
                            src={getImageUrl({
                                collection: expand?.SectionImage,
                                filename: expand?.SectionImage?.Image,
                            })}
                            alt={expand?.SectionImage?.ImageAlt}
                            widths={[240, 540, 800]}
                            sizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, 800px`}
                            inferSize
                            loading="lazy"
                            decoding="async"
                            class="object-cover w-full h-56 rounded shadow-lg sm:h-full"
                        />
                    ) : (
                        <iframe
                            src={IframeSrc}
                            width="100%"
                            height="450"
                            style="border:0;"
                            allowfullscreen=""
                            title={SectionTitle}
                            loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade"
                        />
                    )
                }
            </div>
        </div>
        {
            IframeSrc ? (
                SectionImage ? (
                    <div class="border my-8">
                        <iframe
                            src={IframeSrc}
                            width="100%"
                            height="300"
                            style="border:0;"
                            allowfullscreen=""
                            title={SectionTitle}
                            loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade"
                        />
                    </div>
                ) : null
            ) : null
        }
    </div>
</section>
